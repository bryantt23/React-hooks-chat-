<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
  </head>
  <body>
    <div id="mydiv"></div>

    <script type="text/babel">
      /*
      have the parent have all of the state including
      chat partners (id & names), chat history
      state - current chat id
      map a list of buttons with chat names
      have the onclick of the button set the state of the current chat history on the right side

      the current chat history will be a component that uses map to show the chats
      will prob have to use a hook maybe use effect to get the right chats to show based on the state of the button clicked on the left side
      when a chat is entered push to the array

      super easy part
      first build the data which should take a couple of minutes

      easy part
      render the buttons that show chat name and id
      show the current chat id if it is null then write no active chat

      medium part
      have the button click change the current chat state

      harder part
      on button click have the chat component render, prob using the state of the chat id
      first just get the chat id and name on each button click in console log

      next have the button click make the chat component change i.e. chat with john, mary, terry

      next render the list of chats/chat history with each button click

      next add a button in the component that adds "foo" on click and see if it persists even when switching chats

      swap out this functionality with an input box that does the same thing on pressing enter



      */

      let chatNames = ["John", "Mary", "Tim"];
      let chats = [
        ["Hi from John", "Hello John"],
        ["Hi from Mary", "Hello Mary"],
        ["Hi from Tim", "Hello Tim"],
      ];

      let chatObject = {
        John: ["Hi from John", "Hello John"],
        Mary: ["Hi from Mary", "Hello John"],
        Tim: ["Hi from Tim", "Hello Tim"],
      };

      class App extends React.Component {
        constructor(props) {
          super(props);
          this.state = {
            chatPartnerId: -1,
          };
        }

        addToChat(id, message) {
          console.log(id + " " + message);
          chats[id].push(message);
        }

        render() {
          const names = chatNames.map((chatName, index) => (
            <button
              onClick={() => {
                this.setState({ chatPartnerId: index });
              }}
            >
              {chatName}
            </button>
          ));

          return (
            <div>
              <p>Current chat id: {this.state.chatPartnerId}</p>

              {names}
              <div></div>
              {this.state.chatPartnerId === -1 ? (
                <p>Start a chat</p>
              ) : (
                <Chat
                  id={this.state.chatPartnerId}
                  name={chatNames[this.state.chatPartnerId]}
                  chatHistory={chats[this.state.chatPartnerId]}
                  addToChat={this.addToChat}
                />
              )}
            </div>
          );
        }
      }

      class Chat extends React.Component {
        constructor(props) {
          super(props);
        }
        render() {
          const { name, id, chatHistory, addToChat } = this.props;
          const messages = chatHistory.map((message) => <p>{message}</p>);
          return (
            <div>
              <p>
                `Chatting with Id:${id} Name: ${name}`
              </p>
              {messages}
              <button
                onClick={() => {
                  addToChat(id, "hiiiiiiii");
                }}
              >
                Add Message
              </button>
            </div>
          );
        }
      }

      ReactDOM.render(<App />, document.getElementById("mydiv"));
    </script>
  </body>
</html>
